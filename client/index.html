
<!DOCTYPE html>
<html>
<head>
    
    <title>generative text</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>


    <style>
        html, body {
            height: 100%;
            margin: 0;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        .tile {
            color: black;
            font-family: Futura, sans-serif;
            font-size: 28px;
        }
    </style>
</head>
<body>

<div id='map'></div>

<script type="text/javascript">

    function getRandomSentence(tile, language) {
        fetch('http://localhost:2303/boleros/' + language)
        .then(function(response) {
          return response.json();
        }).then(function(json) {
            tile.innerHTML = json['sentence'];
        });
    }

    L.GridLayer.Boleros = L.GridLayer.extend({
        createTile: function (coords, done) {
            var language = this.options.language;
            var tile = document.createElement('div');
            var response = getRandomSentence(tile, language);
            var content = "unavailable";
            if(response != null){
                content = response["sentence"];
            }
            tile.className = 'tile';
            setTimeout(function () {
                    done(null, tile);
            }, Math.random() * 500);
            return tile;
        }
    });
    
    L.gridLayer.debugCoords = function(opts) {
        return new L.GridLayer.Boleros(opts);
    };

    


    var map = L.map('map', {
        center: [21.682964, -101.773240],
        zoom: 4
    });
    var Esri_WorldPhysical = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Tiles &copy; Esri &mdash; Source: US National Park Service',
        maxZoom: 8
    }).addTo(map);

    var esLayer = L.gridLayer.debugCoords({language:"es"}).addTo(map);
    var enLayer = L.gridLayer.debugCoords({language:"en"});

    L.control.layers({"es": esLayer,
                      "en": enLayer}, {}).addTo(map);

</script>
</body>
</html>